---
name: report-health-events
description: Generate recent health events and episodes timeline section. Use when user asks "generate health events report", "recent health history for doctor", "health timeline summary", or needs a saveable document of recent health episodes.
---

# Report: Health Events

Generate a standardized section documenting recent health events and episodes for provider visits.

## Purpose

This report section provides:
- Active/ongoing health episodes
- Recently resolved episodes (last 6 months)
- Chronological timeline with episode grouping
- Upcoming follow-ups or pending items

## Workflow

1. Load profile and extract `health_log_path`
2. Extract recent events from health_log.csv
3. Group events by episode_id
4. Classify episodes as active or resolved
5. Identify any pending follow-ups
6. Format into standardized section
7. Save to `.output/{profile}/sections/health-events-{date}.md`

## Efficient Data Access

### Extract Recent Events (Last 6 Months)
```bash
head -1 "{health_log_path}/health_log.csv" && grep "^202[56]-" "{health_log_path}/health_log.csv" | sort -t',' -k1 -r
```

### Extract Events by Episode
```bash
head -1 "{health_log_path}/health_log.csv" && grep "{episode_id}" "{health_log_path}/health_log.csv"
```

### Extract Context from Narrative
```bash
grep -A 10 "^# {YYYY-MM-DD}" "{health_log_path}/health_log.md"
```

### Search for Follow-ups/Pending Items
```bash
grep -iE "(follow.?up|scheduled|pending|todo|appointment)" "{health_log_path}/health_log.csv"
```

## Episode Classification

### Active Episodes
Episodes are **active** if:
- Most recent event is NOT a resolution event
- Contains ongoing symptoms or conditions
- Has pending follow-ups or treatments

### Resolution Keywords
- resolved, recovered, completed, cleared
- healed, finished, ended, normal
- negative (for test results)

### Resolved Episodes
Episodes are **resolved** if:
- Most recent event contains resolution keywords
- No events in last 30 days AND last event was treatment completion
- Explicitly marked as resolved in health_log.md

## Output Format

The section must follow this exact format for composability:

```markdown
---
section: health-events
generated: {YYYY-MM-DD}
profile: {profile_name}
period: last 6 months
---

# Recent Health Events

## Active/Ongoing Episodes

### {Episode Description} ({episode_id})
**Status**: Active | Started: {date}

| Date | Category | Event | Details |
|------|----------|-------|---------|
| {date} | {category} | {event} | {details} |

**Current Status**: {brief summary of where this episode stands}

---

### {Next Episode}
...

## Recently Resolved Episodes (Last 6 Months)

### {Episode Description} ({episode_id})
**Period**: {start_date} to {end_date} | **Outcome**: {outcome}

| Date | Category | Event |
|------|----------|-------|
| {date} | {category} | {event} |

**Resolution**: {how it resolved}

---

## Upcoming Follow-ups

| Date | Item | Details |
|------|------|---------|
| {date} | {appointment/task} | {details} |

*No scheduled follow-ups* (if none)

## Summary

- **Active episodes**: {count}
- **Resolved in last 6 months**: {count}
- **Pending follow-ups**: {count}

---
*Section generated by health-agent report-health-events skill*
```

## Output File

- **Directory**: `.output/{profile}/sections/`
- **Filename**: `health-events-YYYY-MM-DD.md`
- **Create directory if needed**: `mkdir -p .output/{profile}/sections`

## Section Header Requirements

For composability with other report sections:
1. Include YAML frontmatter with section name, date, profile, and period
2. Use consistent H1 header format
3. Separate each episode with horizontal rules
4. End with summary statistics and attribution line

## Event Categories

Common categories to group by:
- **symptom**: Physical symptoms experienced
- **condition**: Diagnosed conditions
- **medication**: Medication events (covered by medication-list)
- **procedure**: Medical procedures or tests
- **appointment**: Healthcare visits
- **lifestyle**: Diet, exercise, sleep changes

## Episode Grouping

1. First, group events by `episode_id`
2. For events without episode_id, attempt to cluster by:
   - Temporal proximity (within 7 days)
   - Related category/keywords
   - Referenced in same health_log.md entry
3. Present ungrouped significant events separately

## Special Considerations

- **Privacy**: Summarize sensitive details appropriately
- **Chronology**: Within each episode, sort events chronologically
- **Context**: Pull brief context from health_log.md for active episodes
- **Provider Focus**: Emphasize clinically relevant events
