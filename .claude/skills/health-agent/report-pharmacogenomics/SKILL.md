---
name: report-pharmacogenomics
description: Generate pharmacogenomics report section for provider visits. Use when user asks "pharmacogenomics report for doctor", "medication genetics for provider", "PGx report for appointment", or needs a saveable pharmacogenomics document for healthcare providers.
---

# Report: Pharmacogenomics Summary

Generate a standardized pharmacogenomics section suitable for provider visits and medical records.

## Purpose

This report section provides:
- Current metabolizer status for key drug-metabolizing enzymes
- Specific medication implications
- Format optimized for sharing with healthcare providers
- Actionable recommendations with appropriate caveats

## Prerequisites

- Profile must have `genetics_23andme_path` configured
- Reference: `references/genetics-pharmacogenomics.md`

## Workflow

1. Load profile and extract `genetics_23andme_path`
2. Extract all pharmacogenomics SNPs
3. Determine metabolizer status for each gene
4. Identify medications affected
5. Format into standardized section
6. Save to `.output/{profile}/sections/pharmacogenomics-{date}.md`

## Efficient Data Access

### Extract Pharmacogenomics SNPs
```bash
grep -E "^(rs3892097|rs1065852|rs5030655|rs28371725|rs4244285|rs4986893|rs12248560|rs1799853|rs1057910|rs9923231|rs4149056|rs1800460|rs1142345|rs3918290|rs55886062|rs67376798|rs75017182)" "{genetics_23andme_path}"
```

### Get Current Medications (Optional)
```bash
head -1 "{health_log_path}/health_log.csv" && grep -iE ",(medication)," "{health_log_path}/health_log.csv" | grep -iE "(started|taking|continued|refilled)" | sort -t',' -k1 -r
```

## Output Format

The section must follow this exact format for composability:

```markdown
---
section: pharmacogenomics
generated: {YYYY-MM-DD}
profile: {profile_name}
source: 23andMe raw data (consumer genetic test)
---

# Pharmacogenomics Summary

## Test Information

| Field | Value |
|-------|-------|
| Data Source | 23andMe raw data |
| Analysis Date | {YYYY-MM-DD} |
| SNPs Analyzed | {count} |

**Important**: This is a consumer genetic test, not a clinical pharmacogenomics panel. Results should be confirmed with clinical testing before making medication decisions.

---

## Metabolizer Status Summary

| Gene | Status | Key Implications |
|------|--------|------------------|
| CYP2D6 | {status} | {brief implication} |
| CYP2C19 | {status} | {brief implication} |
| CYP2C9 | {status} | {brief implication} |
| VKORC1 | {status} | {brief implication} |
| SLCO1B1 | {status} | {brief implication} |
| TPMT | {status} | {brief implication} |
| DPYD | {status} | {brief implication} |

---

## Medications Requiring Attention

### Medications to Use with Caution

| Drug Class | Examples | Reason | Recommendation |
|------------|----------|--------|----------------|
| {class} | {examples} | {your status} | {action} |

### Medications with No Genetic Concerns Detected

Standard dosing expected for medications metabolized by pathways with normal status.

---

## Detailed Genotypes

| Gene | SNP | Genotype | Interpretation |
|------|-----|----------|----------------|
| CYP2D6 | rs3892097 | {genotype} | {allele} |
| CYP2D6 | rs1065852 | {genotype} | {allele} |
| CYP2C19 | rs4244285 | {genotype} | {allele} |
| CYP2C19 | rs12248560 | {genotype} | {allele} |
| CYP2C9 | rs1799853 | {genotype} | {allele} |
| CYP2C9 | rs1057910 | {genotype} | {allele} |
| VKORC1 | rs9923231 | {genotype} | {sensitivity} |
| SLCO1B1 | rs4149056 | {genotype} | {transport} |
| TPMT | rs1800460 | {genotype} | {activity} |
| TPMT | rs1142345 | {genotype} | {activity} |
| DPYD | rs3918290 | {genotype} | {activity} |

---

## Provider Notes

1. **Confirmation recommended**: Consumer genetic testing has limitations; clinical pharmacogenomic testing may be warranted for critical medications
2. **Copy number variations**: CYP2D6 gene duplications/deletions are NOT detected by this test
3. **Incomplete coverage**: Not all variants are tested; normal results do not guarantee typical metabolism
4. **CPIC Guidelines**: For formal dosing recommendations, consult CPIC (cpicpgx.org)

---

## Current Medications Review

{If medications available from health_log:}

| Medication | Relevant Gene | Patient Status | Consideration |
|------------|---------------|----------------|---------------|
| {med} | {gene} | {status} | {note} |

{If no medications available:}

Review current medications against the metabolizer status above. Key interactions:
- CYP2D6: codeine, tramadol, metoprolol, many antidepressants
- CYP2C19: clopidogrel, PPIs, citalopram
- Warfarin: CYP2C9 + VKORC1 combined

---
*Section generated by health-agent report-pharmacogenomics skill*
```

## Output File

- **Directory**: `.output/{profile}/sections/`
- **Filename**: `pharmacogenomics-YYYY-MM-DD.md`
- **Create directory if needed**: `mkdir -p .output/{profile}/sections`

## Section Header Requirements

For composability with other report sections:
1. Include YAML frontmatter with section name, date, profile, and source
2. Use consistent H1 header format
3. End with horizontal rule and attribution line
4. Tables must be valid markdown for concatenation

## Provider-Friendly Formatting

- Use medical terminology appropriate for healthcare providers
- Include actionable recommendations
- Emphasize limitations clearly
- Provide genotype data for their records
- Reference CPIC for clinical guidelines

## Status Determination

Use the logic from `references/genetics-pharmacogenomics.md` to determine metabolizer status:

| Status | Description |
|--------|-------------|
| Normal Metabolizer | Standard drug metabolism expected |
| Intermediate Metabolizer | Reduced metabolism; may need dose adjustment |
| Poor Metabolizer | Significantly reduced; major dosing changes or alternatives |
| Ultra-rapid Metabolizer | Increased metabolism; may need higher doses or alternatives |
| Increased Sensitivity | (VKORC1) Lower warfarin doses needed |

## Combining with Other Reports

This section is designed to combine with:
- `report-medication-list` - Current medications
- `report-genetic-risks` - Health risk variants

Combined report for provider visit:
1. Medication list + pharmacogenomics = comprehensive medication review
2. All genetics sections = complete genetic summary
